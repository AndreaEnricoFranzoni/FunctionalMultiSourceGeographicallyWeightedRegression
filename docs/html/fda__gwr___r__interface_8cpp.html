<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fdagwr: src/fda_gwr_R_interface.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">fdagwr
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('fda__gwr___r__interface_8cpp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">fda_gwr_R_interface.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains the R-interfaced main functions of the package 'fdagwr', which implement Functional Geographical Weighted Regression coefficients estimation, for different (multi-source (FMSGWR), mixed (FMGWR), geographically weighted (FGWR) and weighted (FWR)) functional regression models.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;RcppEigen.h&gt;</code><br />
<code>#include &quot;<a class="el" href="include__fdagwr_8hpp_source.html">utility/include_fdagwr.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="traits__fdagwr_8hpp_source.html">utility/traits_fdagwr.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="concepts__fdagwr_8hpp_source.html">utility/concepts_fdagwr.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utility__fdagwr_8hpp_source.html">utility/utility_fdagwr.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="data__reader_8hpp_source.html">utility/data_reader.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parameters__wrapper__fdagwr_8hpp_source.html">utility/parameters_wrapper_fdagwr.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="basis__include_8hpp_source.html">basis/basis_include.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="basis__bspline__systems_8hpp_source.html">basis/basis_bspline_systems.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="basis__factory__proxy_8hpp_source.html">basis/basis_factory_proxy.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__data_8hpp_source.html">functional_data/functional_data.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__data__covariates_8hpp_source.html">functional_data/functional_data_covariates.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__weight__matrix__stat_8hpp_source.html">weight_matrix/functional_weight_matrix_stat.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__weight__matrix__no__stat_8hpp_source.html">weight_matrix/functional_weight_matrix_no_stat.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="distance__matrix_8hpp_source.html">weight_matrix/distance_matrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="distance__matrix__pred_8hpp_source.html">weight_matrix/distance_matrix_pred.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="penalization__matrix_8hpp_source.html">penalization_matrix/penalization_matrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix_8hpp_source.html">functional_matrix/functional_matrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix__sparse_8hpp_source.html">functional_matrix/functional_matrix_sparse.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix__diagonal_8hpp_source.html">functional_matrix/functional_matrix_diagonal.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix__operators_8hpp_source.html">functional_matrix/functional_matrix_operators.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix__product_8hpp_source.html">functional_matrix/functional_matrix_product.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functional__matrix__into__wrapper_8hpp_source.html">functional_matrix/functional_matrix_into_wrapper.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fwr__factory_8hpp_source.html">fwr/fwr_factory.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fwr__predictor__factory_8hpp_source.html">fwr_predictor/fwr_predictor_factory.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fda_gwr_R_interface.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp__incl.png" border="0" usemap="#asrc_2fda__gwr___r__interface_8cpp" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab1a6dc026ab68e19a1483bb7989a9c7e" id="r_ab1a6dc026ab68e19a1483bb7989a9c7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1a6dc026ab68e19a1483bb7989a9c7e">installation_fdagwr</a> ()</td></tr>
<tr class="memdesc:ab1a6dc026ab68e19a1483bb7989a9c7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check fdagwr package installation.  <br /></td></tr>
<tr class="separator:ab1a6dc026ab68e19a1483bb7989a9c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2868ec905e0f8714b773c423f63d3eb" id="r_ab2868ec905e0f8714b773c423f63d3eb"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2868ec905e0f8714b773c423f63d3eb">FMSGWR_ESC</a> (Rcpp::NumericMatrix y_points, Rcpp::NumericVector t_points, double left_extreme_domain, double right_extreme_domain, Rcpp::NumericMatrix coeff_y_points, Rcpp::NumericVector knots_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_y_points, Rcpp::Nullable&lt; int &gt; n_basis_y_points, Rcpp::NumericMatrix coeff_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; n_basis_rec_weights_y_points, Rcpp::List coeff_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stationary_cov, Rcpp::NumericVector knots_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stationary_cov, Rcpp::NumericVector penalization_stationary_cov, Rcpp::NumericVector knots_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stationary_cov, Rcpp::List coeff_events_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_events_cov, Rcpp::NumericVector knots_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_events_cov, Rcpp::NumericVector penalization_events_cov, Rcpp::NumericMatrix coordinates_events, double kernel_bandwith_events, Rcpp::NumericVector knots_beta_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_events_cov, Rcpp::List coeff_stations_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stations_cov, Rcpp::NumericVector knots_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stations_cov, Rcpp::NumericVector penalization_stations_cov, Rcpp::NumericMatrix coordinates_stations, double kernel_bandwith_stations, Rcpp::NumericVector knots_beta_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stations_cov, bool in_cascade_estimation=false, int n_knots_smoothing=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue, std::string basis_type_y_points=&quot;bsplines&quot;, std::string basis_type_rec_weights_y_points=&quot;bsplines&quot;, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stationary_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_events_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stations_cov=R_NilValue)</td></tr>
<tr class="memdesc:ab2868ec905e0f8714b773c423f63d3eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fitting a Functional Multi-Source Geographically Weighted Regression ESC model. The covariates are functional objects, divided into three categories: stationary covariates (C), constant over geographical space, event-dependent covariates (E), that vary depending on the spatial coordinates of the event, station-dependent covariates (S), that vary depending on the spatial coordinates of the stations that measure the event. Regression coefficients are estimated in the following order: C, S, E. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below)  <br /></td></tr>
<tr class="separator:ab2868ec905e0f8714b773c423f63d3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00c87d9118ac0d945788764202c01e3" id="r_ab00c87d9118ac0d945788764202c01e3"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab00c87d9118ac0d945788764202c01e3">predict_FMSGWR_ESC</a> (Rcpp::List coeff_stationary_cov_to_pred, Rcpp::List coeff_events_cov_to_pred, Rcpp::NumericMatrix coordinates_events_to_pred, Rcpp::List coeff_stations_cov_to_pred, Rcpp::NumericMatrix coordinates_stations_to_pred, int units_to_be_predicted, Rcpp::NumericVector abscissa_ev, Rcpp::List model_fitted, int n_knots_smoothing_pred=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue)</td></tr>
<tr class="memdesc:ab00c87d9118ac0d945788764202c01e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform predictions on new statistical units using a fitted Functional Multi-Source Geographically Weighted Regression ESC model. Non-stationary betas have to be recomputed in the new locations.  <br /></td></tr>
<tr class="separator:ab00c87d9118ac0d945788764202c01e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa047822d2daf52e16fc2bd9d55fa38ff" id="r_aa047822d2daf52e16fc2bd9d55fa38ff"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa047822d2daf52e16fc2bd9d55fa38ff">FMSGWR_SEC</a> (Rcpp::NumericMatrix y_points, Rcpp::NumericVector t_points, double left_extreme_domain, double right_extreme_domain, Rcpp::NumericMatrix coeff_y_points, Rcpp::NumericVector knots_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_y_points, Rcpp::Nullable&lt; int &gt; n_basis_y_points, Rcpp::NumericMatrix coeff_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; n_basis_rec_weights_y_points, Rcpp::List coeff_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stationary_cov, Rcpp::NumericVector knots_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stationary_cov, Rcpp::NumericVector penalization_stationary_cov, Rcpp::NumericVector knots_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stationary_cov, Rcpp::List coeff_events_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_events_cov, Rcpp::NumericVector knots_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_events_cov, Rcpp::NumericVector penalization_events_cov, Rcpp::NumericMatrix coordinates_events, double kernel_bandwith_events, Rcpp::NumericVector knots_beta_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_events_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_events_cov, Rcpp::List coeff_stations_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stations_cov, Rcpp::NumericVector knots_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stations_cov, Rcpp::NumericVector penalization_stations_cov, Rcpp::NumericMatrix coordinates_stations, double kernel_bandwith_stations, Rcpp::NumericVector knots_beta_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stations_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stations_cov, bool in_cascade_estimation=false, int n_knots_smoothing=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue, std::string basis_type_y_points=&quot;bsplines&quot;, std::string basis_type_rec_weights_y_points=&quot;bsplines&quot;, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stationary_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_events_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stations_cov=R_NilValue)</td></tr>
<tr class="memdesc:aa047822d2daf52e16fc2bd9d55fa38ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fitting a Functional Multi-Source Geographically Weighted Regression SEC model. The covariates are functional objects, divided into three categories: stationary covariates (C), constant over geographical space, event-dependent covariates (E), that vary depending on the spatial coordinates of the event, station-dependent covariates (S), that vary depending on the spatial coordinates of the stations that measure the event. Regression coefficients are estimated in the following order: C, E, S. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below)  <br /></td></tr>
<tr class="separator:aa047822d2daf52e16fc2bd9d55fa38ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96430b819b4aca0b81fad6da2b4ff26" id="r_ab96430b819b4aca0b81fad6da2b4ff26"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab96430b819b4aca0b81fad6da2b4ff26">predict_FMSGWR_SEC</a> (Rcpp::List coeff_stationary_cov_to_pred, Rcpp::List coeff_events_cov_to_pred, Rcpp::NumericMatrix coordinates_events_to_pred, Rcpp::List coeff_stations_cov_to_pred, Rcpp::NumericMatrix coordinates_stations_to_pred, int units_to_be_predicted, Rcpp::NumericVector abscissa_ev, Rcpp::List model_fitted, int n_knots_smoothing_pred=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue)</td></tr>
<tr class="memdesc:ab96430b819b4aca0b81fad6da2b4ff26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform predictions on new statistical units using a fitted Functional Multi-Source Geographically Weighted Regression SEC model. Non-stationary betas have to be recomputed in the new locations.  <br /></td></tr>
<tr class="separator:ab96430b819b4aca0b81fad6da2b4ff26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ee1755500ce419168740a317a5552c" id="r_ac7ee1755500ce419168740a317a5552c"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7ee1755500ce419168740a317a5552c">FMGWR</a> (Rcpp::NumericMatrix y_points, Rcpp::NumericVector t_points, double left_extreme_domain, double right_extreme_domain, Rcpp::NumericMatrix coeff_y_points, Rcpp::NumericVector knots_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_y_points, Rcpp::Nullable&lt; int &gt; n_basis_y_points, Rcpp::NumericMatrix coeff_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; n_basis_rec_weights_y_points, Rcpp::List coeff_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stationary_cov, Rcpp::NumericVector knots_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stationary_cov, Rcpp::NumericVector penalization_stationary_cov, Rcpp::NumericVector knots_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stationary_cov, Rcpp::List coeff_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_non_stationary_cov, Rcpp::NumericVector knots_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_non_stationary_cov, Rcpp::NumericVector penalization_non_stationary_cov, Rcpp::NumericMatrix coordinates_non_stationary, double kernel_bandwith_non_stationary, Rcpp::NumericVector knots_beta_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_non_stationary_cov, bool in_cascade_estimation=false, int n_knots_smoothing=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue, std::string basis_type_y_points=&quot;bsplines&quot;, std::string basis_type_rec_weights_y_points=&quot;bsplines&quot;, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stationary_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_non_stationary_cov=R_NilValue)</td></tr>
<tr class="memdesc:ac7ee1755500ce419168740a317a5552c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fitting a Functional Mixed Geographically Weighted Regression model. The covariates are functional objects, divided into two categories: stationary covariates (C), constant over geographical space, and non-stationary covariates (NC), that vary depending on spatial coordinates. Regression coefficients are estimated in the following order: C, NC. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below)  <br /></td></tr>
<tr class="separator:ac7ee1755500ce419168740a317a5552c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e1b7194996c682ee8a9c80162c4433" id="r_a58e1b7194996c682ee8a9c80162c4433"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58e1b7194996c682ee8a9c80162c4433">predict_FMGWR</a> (Rcpp::List coeff_stationary_cov_to_pred, Rcpp::List coeff_non_stationary_cov_to_pred, Rcpp::NumericMatrix coordinates_non_stationary_to_pred, int units_to_be_predicted, Rcpp::NumericVector abscissa_ev, Rcpp::List model_fitted, int n_knots_smoothing_pred=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue)</td></tr>
<tr class="memdesc:a58e1b7194996c682ee8a9c80162c4433"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform predictions on new statistical units using a fitted Functional Mixed Geographically Weighted Regression model. Non-stationary betas have to be recomputed in the new locations.  <br /></td></tr>
<tr class="separator:a58e1b7194996c682ee8a9c80162c4433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05363791c6e68d6b6ef38bdd2957df7" id="r_af05363791c6e68d6b6ef38bdd2957df7"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af05363791c6e68d6b6ef38bdd2957df7">FGWR</a> (Rcpp::NumericMatrix y_points, Rcpp::NumericVector t_points, double left_extreme_domain, double right_extreme_domain, Rcpp::NumericMatrix coeff_y_points, Rcpp::NumericVector knots_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_y_points, Rcpp::Nullable&lt; int &gt; n_basis_y_points, Rcpp::NumericMatrix coeff_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; n_basis_rec_weights_y_points, Rcpp::List coeff_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_non_stationary_cov, Rcpp::NumericVector knots_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_non_stationary_cov, Rcpp::NumericVector penalization_non_stationary_cov, Rcpp::NumericMatrix coordinates_non_stationary, double kernel_bandwith_non_stationary, Rcpp::NumericVector knots_beta_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_non_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_non_stationary_cov, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue, std::string basis_type_y_points=&quot;bsplines&quot;, std::string basis_type_rec_weights_y_points=&quot;bsplines&quot;, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stationary_cov=R_NilValue, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_non_stationary_cov=R_NilValue)</td></tr>
<tr class="memdesc:af05363791c6e68d6b6ef38bdd2957df7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fitting a Functional Geographically Weighted Regression model. The covariates are functional objects, non-stationary covariates (NC), that vary depending on spatial coordinates. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below)  <br /></td></tr>
<tr class="separator:af05363791c6e68d6b6ef38bdd2957df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1232970b791dea772ef48d61fc329d87" id="r_a1232970b791dea772ef48d61fc329d87"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1232970b791dea772ef48d61fc329d87">predict_FGWR</a> (Rcpp::List coeff_non_stationary_cov_to_pred, Rcpp::NumericMatrix coordinates_non_stationary_to_pred, int units_to_be_predicted, Rcpp::NumericVector abscissa_ev, Rcpp::List model_fitted, int n_knots_smoothing_pred=100, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue)</td></tr>
<tr class="memdesc:a1232970b791dea772ef48d61fc329d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform predictions on new statistical units using a fitted Functional Geographically Weighted Regression model. Non-stationary betas have to be recomputed in the new locations.  <br /></td></tr>
<tr class="separator:a1232970b791dea772ef48d61fc329d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca1a9836bffb181af6fc761393d23f1" id="r_a1ca1a9836bffb181af6fc761393d23f1"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ca1a9836bffb181af6fc761393d23f1">FWR</a> (Rcpp::NumericMatrix y_points, Rcpp::NumericVector t_points, double left_extreme_domain, double right_extreme_domain, Rcpp::NumericMatrix coeff_y_points, Rcpp::NumericVector knots_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_y_points, Rcpp::Nullable&lt; int &gt; n_basis_y_points, Rcpp::NumericMatrix coeff_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; degree_basis_rec_weights_y_points, Rcpp::Nullable&lt; int &gt; n_basis_rec_weights_y_points, Rcpp::List coeff_stationary_cov, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_stationary_cov, Rcpp::NumericVector knots_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_stationary_cov, Rcpp::NumericVector penalization_stationary_cov, Rcpp::NumericVector knots_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; degrees_basis_beta_stationary_cov, Rcpp::Nullable&lt; Rcpp::IntegerVector &gt; n_basis_beta_stationary_cov, int n_intervals_quadrature=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue, std::string basis_type_y_points=&quot;bsplines&quot;, std::string basis_type_rec_weights_y_points=&quot;bsplines&quot;, Rcpp::Nullable&lt; Rcpp::CharacterVector &gt; basis_types_beta_stationary_cov=R_NilValue)</td></tr>
<tr class="memdesc:a1ca1a9836bffb181af6fc761393d23f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fitting a Functional Weighted Regression model. The covariates are functional objects, stationary covariates (C), constant over geographical space. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below)  <br /></td></tr>
<tr class="separator:a1ca1a9836bffb181af6fc761393d23f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051f0f57690b5a9ff81b9008b4bcee84" id="r_a051f0f57690b5a9ff81b9008b4bcee84"><td class="memItemLeft" align="right" valign="top">Rcpp::List&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a051f0f57690b5a9ff81b9008b4bcee84">predict_FWR</a> (Rcpp::List coeff_stationary_cov_to_pred, int units_to_be_predicted, Rcpp::NumericVector abscissa_ev, Rcpp::List model_fitted, int n_knots_smoothing_pred=100, Rcpp::Nullable&lt; int &gt; num_threads=R_NilValue)</td></tr>
<tr class="memdesc:a051f0f57690b5a9ff81b9008b4bcee84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform predictions on new statistical units using a fitted Functional Weighted Regression model.  <br /></td></tr>
<tr class="separator:a051f0f57690b5a9ff81b9008b4bcee84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains the R-interfaced main functions of the package 'fdagwr', which implement Functional Geographical Weighted Regression coefficients estimation, for different (multi-source (FMSGWR), mixed (FMGWR), geographically weighted (FGWR) and weighted (FWR)) functional regression models. </p>
<dl class="section author"><dt>Author</dt><dd>Andrea Enrico Franzoni </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af05363791c6e68d6b6ef38bdd2957df7" name="af05363791c6e68d6b6ef38bdd2957df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af05363791c6e68d6b6ef38bdd2957df7">&#9670;&#160;</a></span>FGWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List FGWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>t_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>left_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>right_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_non_stationary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_non_stationary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_rec_weights_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_non_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fitting a Functional Geographically Weighted Regression model. The covariates are functional objects, non-stationary covariates (NC), that vary depending on spatial coordinates. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_points</td><td>matrix of double containing the raw response: each row represents a specific abscissa for which the response evaluation is available, each column a statistical unit. Response is a already reconstructed. </td></tr>
    <tr><td class="paramname">t_points</td><td>vector of double with the abscissa points with respect of the raw evaluations of y_points are available (length of t_points is equal to the number of rows of y_points). </td></tr>
    <tr><td class="paramname">left_extreme_domain</td><td>double indicating the left extreme of the functional data domain (not necessarily the smaller element in t_points). </td></tr>
    <tr><td class="paramname">right_extreme_domain</td><td>double indicating the right extreme of the functional data domain (not necessarily the biggest element in t_points). </td></tr>
    <tr><td class="paramname">coeff_y_points</td><td>matrix of double containing the coefficient of response's basis expansion: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">knots_y_points</td><td>vector of double with the abscissa points with respect which the basis expansions of the response and response reconstruction weights are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degree_basis_y_points</td><td>non-negative integer: the degree of the basis used for the basis expansion of the (functional) response. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_y_points</td><td>positive integer: number of basis for the basis expansion of the (functional) response. It must match number of rows of coeff_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_rec_weights_y_points</td><td>matrix of double containing the coefficients of the basis expansion of the weights to reconstruct the (functional) response: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">degree_basis_rec_weights_y_points</td><td>non-negative integer: the degree of the basis used for response reconstruction weights. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_rec_weights_y_points</td><td>positive integer: number of basis for the basis expansion of response reconstruction weights. It must match number of rows of coeff_rec_weights_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_non_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th non-stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th non-stationary covariate (default: "reg.NCi" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_non_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th non-stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_non_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the non-stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_non_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th non-stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_non_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th non-stationary covariate. It must match number of rows of the i-th element of coeff_non_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_non_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th non-stationary covariate. </td></tr>
    <tr><td class="paramname">coordinates_non_stationary</td><td>matrix of double containing the UTM coordinates of the non-stationary site of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_non_stationary</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within non-stationary sites. </td></tr>
    <tr><td class="paramname">knots_beta_non_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the non-stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_non_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th non-stationary covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_non_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th non-stationary covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
    <tr><td class="paramname">basis_type_y_points</td><td>string containing the type of basis used for the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_type_rec_weights_y_points</td><td>string containing the type of basis used for the weights to reconstruct the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_non_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FGWR")</li>
<li>"Bnc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Lnc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_non_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_non_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_non_stationary_cov)</li>
</ul>
</li>
<li>"Beta_nc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"predictor_info": a list containing information of the fitted model to perform predictions for new statistical units:<ul>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points). <br  />
</li>
</ul>
</li>
<li>"cov_NonStationary": list:<ul>
<li>"number_covariates": number of non-stationary covariates (length of coeff_non_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional non-stationary covariates (respective elements of n_basis_non_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional non-stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_non_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional non-stationary covariates (respective elements of degrees_basis_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional non-stationary covariates (element knots_non_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional non-stationary covariates (respective elements of coeff_non_stationary_cov).</li>
<li>"penalizations": vector containing the penalizations of the non-stationary covariates (respective elements of penalization_non_stationary_cov)</li>
<li>"coordinates": UTM coordinates of the non-stationary sites of the training data (element coordinates_non_stationary).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the non-stationary sites (element kernel_bandwith_non_stationary).</li>
</ul>
</li>
<li>"beta_NonStationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element n_basis_beta_non_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_non_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element degrees_basis_beta_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element knots_beta_non_stationary_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<p>constant basis are used, for a covariate, if it resembles a scalar shape. It consists of a straight line with y-value equal to 1 all over the data domain. Can be seen as a B-spline basis with degree 0, number of basis 1, using one knot, consequently having only one coefficient for the only basis for each statistical unit. fdagwr sets all the feats accordingly if reads constant basis. However, recall that the response is a functional datum, as the regressors coefficients. Since the package's basis variety could be hopefully enlarged in the future (for example, introducing Fourier basis for handling data that present periodical behaviors), the input parameters regarding basis types for response, response reconstruction weights and regressors coefficients are left at the end of the input list, and defaulted as NULL. Consequently they will use a B-spline basis system, and should NOT use a constant basis, Recall to perform externally the basis expansion before using the package, and afterwards passing basis types, degree and number and basis expansion coefficients and knots coherently </p><dl class="section note"><dt>Note</dt><dd>a little excursion about degree and number of basis passed as input. For each specific covariate, or the response, if using B-spline basis, remember that number of knots = number of basis - degree + 1. By default, if passing NULL, fdagwr uses a cubic B-spline system of basis, the number of basis is computed coherently from the number of knots (that is the only mandatory input parameter). Passing only the degree of the bsplines, the number of basis used will be set accordingly, and viceversa if passing only the number of basis. But, take care that the number of basis used has to match the number of rows of coefficients matrix (for EACH type of basis). If not, an exception is thrown. No problems arise if letting fdagwr defaulting the number of basis. For response and response reconstruction weights, degree and number of basis consist of integer, and can be NULL. For all the regressors, and their coefficients, the inputs consist of vector of integers: if willing to pass a default parameter, all the vector has to be defaulted (if passing NULL, a vector with all 3 for the degrees is passed, for example) <a class="el" href="">https://www.researchgate.net/publication/377251714_Weighted_Functional_Data_Analysis_for_the_Calibration_of_a_Ground_Motion_Model_in_Italy</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_af05363791c6e68d6b6ef38bdd2957df7_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_af05363791c6e68d6b6ef38bdd2957df7_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ac7ee1755500ce419168740a317a5552c" name="ac7ee1755500ce419168740a317a5552c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7ee1755500ce419168740a317a5552c">&#9670;&#160;</a></span>FMGWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List FMGWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>t_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>left_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>right_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_non_stationary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_non_stationary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_non_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>in_cascade_estimation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_rec_weights_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_non_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fitting a Functional Mixed Geographically Weighted Regression model. The covariates are functional objects, divided into two categories: stationary covariates (C), constant over geographical space, and non-stationary covariates (NC), that vary depending on spatial coordinates. Regression coefficients are estimated in the following order: C, NC. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_points</td><td>matrix of double containing the raw response: each row represents a specific abscissa for which the response evaluation is available, each column a statistical unit. Response is a already reconstructed. </td></tr>
    <tr><td class="paramname">t_points</td><td>vector of double with the abscissa points with respect of the raw evaluations of y_points are available (length of t_points is equal to the number of rows of y_points). </td></tr>
    <tr><td class="paramname">left_extreme_domain</td><td>double indicating the left extreme of the functional data domain (not necessarily the smaller element in t_points). </td></tr>
    <tr><td class="paramname">right_extreme_domain</td><td>double indicating the right extreme of the functional data domain (not necessarily the biggest element in t_points). </td></tr>
    <tr><td class="paramname">coeff_y_points</td><td>matrix of double containing the coefficient of response's basis expansion: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">knots_y_points</td><td>vector of double with the abscissa points with respect which the basis expansions of the response and response reconstruction weights are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degree_basis_y_points</td><td>non-negative integer: the degree of the basis used for the basis expansion of the (functional) response. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_y_points</td><td>positive integer: number of basis for the basis expansion of the (functional) response. It must match number of rows of coeff_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_rec_weights_y_points</td><td>matrix of double containing the coefficients of the basis expansion of the weights to reconstruct the (functional) response: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">degree_basis_rec_weights_y_points</td><td>non-negative integer: the degree of the basis used for response reconstruction weights. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_rec_weights_y_points</td><td>positive integer: number of basis for the basis expansion of response reconstruction weights. It must match number of rows of coeff_rec_weights_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stationary covariate (default: "reg.Ci" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate. It must match number of rows of the i-th element of coeff_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stationary covariate. </td></tr>
    <tr><td class="paramname">knots_beta_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_non_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th non-stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th non-stationary covariate (default: "reg.NCi" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_non_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th non-stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_non_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the non-stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_non_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th non-stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_non_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th non-stationary covariate. It must match number of rows of the i-th element of coeff_non_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_non_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th non-stationary covariate. </td></tr>
    <tr><td class="paramname">coordinates_non_stationary</td><td>matrix of double containing the UTM coordinates of the non-stationary site of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_non_stationary</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within non-stationary sites. </td></tr>
    <tr><td class="paramname">knots_beta_non_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the non-stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_non_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th non-stationary covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_non_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th non-stationary covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">in_cascade_estimation</td><td>bool: if false, an exact algorithm taking account for the interaction within non-stationary covariates is used to fit the model. Otherwise, the model is fitted in cascade. The first option is more precise, but way more computationally intensive. </td></tr>
    <tr><td class="paramname">n_knots_smoothing</td><td>number of knots used to perform the smoothing on the response obtained leaving out all the non-stationary components (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
    <tr><td class="paramname">basis_type_y_points</td><td>string containing the type of basis used for the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_type_rec_weights_y_points</td><td>string containing the type of basis used for the weights to reconstruct the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_non_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMGWR")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Bnc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Lnc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_non_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_non_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_non_stationary_cov)</li>
</ul>
</li>
<li>"Beta_nc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_NonStationary": list:<ul>
<li>"number_covariates": number of non-stationary covariates (length of coeff_non_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional non-stationary covariates (respective elements of n_basis_non_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional non-stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_non_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional non-stationary covariates (respective elements of degrees_basis_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional non-stationary covariates (element knots_non_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional non-stationary covariates (respective elements of coeff_non_stationary_cov).</li>
<li>"penalizations": vector containing the penalizations of the non-stationary covariates (respective elements of penalization_non_stationary_cov)</li>
<li>"coordinates": UTM coordinates of the non-stationary sites of the training data (element coordinates_non_stationary).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the non-stationary sites (element kernel_bandwith_non_stationary).</li>
</ul>
</li>
<li>"beta_NonStationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element n_basis_beta_non_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_non_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element degrees_basis_beta_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element knots_beta_non_stationary_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation.</li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<p>constant basis are used, for a covariate, if it resembles a scalar shape. It consists of a straight line with y-value equal to 1 all over the data domain. Can be seen as a B-spline basis with degree 0, number of basis 1, using one knot, consequently having only one coefficient for the only basis for each statistical unit. fdagwr sets all the feats accordingly if reads constant basis. However, recall that the response is a functional datum, as the regressors coefficients. Since the package's basis variety could be hopefully enlarged in the future (for example, introducing Fourier basis for handling data that present periodical behaviors), the input parameters regarding basis types for response, response reconstruction weights and regressors coefficients are left at the end of the input list, and defaulted as NULL. Consequently they will use a B-spline basis system, and should NOT use a constant basis, Recall to perform externally the basis expansion before using the package, and afterwards passing basis types, degree and number and basis expansion coefficients and knots coherently </p><dl class="section note"><dt>Note</dt><dd>a little excursion about degree and number of basis passed as input. For each specific covariate, or the response, if using B-spline basis, remember that number of knots = number of basis - degree + 1. By default, if passing NULL, fdagwr uses a cubic B-spline system of basis, the number of basis is computed coherently from the number of knots (that is the only mandatory input parameter). Passing only the degree of the bsplines, the number of basis used will be set accordingly, and viceversa if passing only the number of basis. But, take care that the number of basis used has to match the number of rows of coefficients matrix (for EACH type of basis). If not, an exception is thrown. No problems arise if letting fdagwr defaulting the number of basis. For response and response reconstruction weights, degree and number of basis consist of integer, and can be NULL. For all the regressors, and their coefficients, the inputs consist of vector of integers: if willing to pass a default parameter, all the vector has to be defaulted (if passing NULL, a vector with all 3 for the degrees is passed, for example) <a class="el" href="">https://www.researchgate.net/publication/377251714_Weighted_Functional_Data_Analysis_for_the_Calibration_of_a_Ground_Motion_Model_in_Italy</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_ac7ee1755500ce419168740a317a5552c_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_ac7ee1755500ce419168740a317a5552c_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab2868ec905e0f8714b773c423f63d3eb" name="ab2868ec905e0f8714b773c423f63d3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2868ec905e0f8714b773c423f63d3eb">&#9670;&#160;</a></span>FMSGWR_ESC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List FMSGWR_ESC </td>
          <td>(</td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>t_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>left_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>right_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_events</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_events</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_stations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_stations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>in_cascade_estimation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_rec_weights_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_events_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stations_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fitting a Functional Multi-Source Geographically Weighted Regression ESC model. The covariates are functional objects, divided into three categories: stationary covariates (C), constant over geographical space, event-dependent covariates (E), that vary depending on the spatial coordinates of the event, station-dependent covariates (S), that vary depending on the spatial coordinates of the stations that measure the event. Regression coefficients are estimated in the following order: C, S, E. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_points</td><td>matrix of double containing the raw response: each row represents a specific abscissa for which the response evaluation is available, each column a statistical unit. Response is a already reconstructed. </td></tr>
    <tr><td class="paramname">t_points</td><td>vector of double with the abscissa points with respect of the raw evaluations of y_points are available (length of t_points is equal to the number of rows of y_points). </td></tr>
    <tr><td class="paramname">left_extreme_domain</td><td>double indicating the left extreme of the functional data domain (not necessarily the smaller element in t_points). </td></tr>
    <tr><td class="paramname">right_extreme_domain</td><td>double indicating the right extreme of the functional data domain (not necessarily the biggest element in t_points). </td></tr>
    <tr><td class="paramname">coeff_y_points</td><td>matrix of double containing the coefficient of response's basis expansion: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">knots_y_points</td><td>vector of double with the abscissa points with respect which the basis expansions of the response and response reconstruction weights are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degree_basis_y_points</td><td>non-negative integer: the degree of the basis used for the basis expansion of the (functional) response. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_y_points</td><td>positive integer: number of basis for the basis expansion of the (functional) response. It must match number of rows of coeff_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_rec_weights_y_points</td><td>matrix of double containing the coefficients of the basis expansion of the weights to reconstruct the (functional) response: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">degree_basis_rec_weights_y_points</td><td>non-negative integer: the degree of the basis used for response reconstruction weights. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_rec_weights_y_points</td><td>positive integer: number of basis for the basis expansion of response reconstruction weights. It must match number of rows of coeff_rec_weights_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stationary covariate (default: "reg.Ci" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate. It must match number of rows of the i-th element of coeff_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stationary covariate. </td></tr>
    <tr><td class="paramname">knots_beta_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_events_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th events-dependent covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th events-dependent covariate (default: "reg.Ei" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_events_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_events_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the events-dependent covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_events_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th events-dependent covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_events_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th events-dependent covariate. It must match number of rows of the i-th element of coeff_events_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_events_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th events-dependent covariate. </td></tr>
    <tr><td class="paramname">coordinates_events</td><td>matrix of double containing the UTM coordinates of the event of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_events</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within events. </td></tr>
    <tr><td class="paramname">knots_beta_events_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the events-dependent covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_events_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th events-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_events_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th events-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stations_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stations-dependent covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stations-dependent covariate (default: "reg.Si"). </td></tr>
    <tr><td class="paramname">basis_types_stations_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stations-dependent covariates basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stations_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stations-dependent covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stations_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stations-dependent covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stations_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stations-dependent covariate. It must match number of rows of the i-th element of coeff_stations_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stations_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stations-dependent covariate. </td></tr>
    <tr><td class="paramname">coordinates_stations</td><td>matrix of double containing the UTM coordinates of the station of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_stations</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within stations. </td></tr>
    <tr><td class="paramname">knots_beta_stations_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stations-dependent covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stations_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stations-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stations_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stations-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">in_cascade_estimation</td><td>bool: if false, an exact algorithm taking account for the interaction within non-stationary covariates is used to fit the model. Otherwise, the model is fitted in cascade. The first option is more precise, but way more computationally intensive. </td></tr>
    <tr><td class="paramname">n_knots_smoothing</td><td>number of knots used to perform the smoothing on the response obtained leaving out all the non-stationary components (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
    <tr><td class="paramname">basis_type_y_points</td><td>string containing the type of basis used for the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_type_rec_weights_y_points</td><td>string containing the type of basis used for the weights to reconstruct the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_events_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stations_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stations-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMSGWR_ESC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Be": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Le_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_events_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_events_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_events_cov)</li>
</ul>
</li>
<li>"Beta_e": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"Bs": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Ls_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_stations_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stations_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stations_cov)</li>
</ul>
</li>
<li>"Beta_s": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
<li>"A__": vector of matrices with the operator A_e for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
<li>"B__for_K": vector of matrices with the operator B_e used for the K_e_s(t) computation, for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_Event": list:<ul>
<li>"number_covariates": number of event-dependent covariates (length of coeff_events_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional event-dependent covariates (respective elements of n_basis_events_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional event-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_events_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional event-dependent covariates (respective elements of degrees_basis_events_cov).</li>
<li>"knots": knots used to make the basis expansion of functional event-dependent covariates (element knots_events_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional event-dependent covariates (respective elements of coeff_events_cov).</li>
<li>"penalizations": vector containing the penalizations of the event-dependent covariates (respective elements of penalization_events_cov)</li>
<li>"coordinates": UTM coordinates of the events of the training data (element coordinates_events).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the events (element kernel_bandwith_events).</li>
</ul>
</li>
<li>"beta_Event": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element n_basis_beta_events_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_events_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element degrees_basis_beta_events_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element knots_beta_events_cov).</li>
</ul>
</li>
<li>"cov_Station": list:<ul>
<li>"number_covariates": number of station-dependent covariates (length of coeff_stations_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional station-dependent covariates (respective elements of n_basis_stations_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional station-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stations_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional station-dependent covariates (respective elements of degrees_basis_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of functional station-dependent covariates (element knots_stations_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional station-dependent covariates (respective elements of coeff_stations_cov).</li>
<li>"penalizations": vector containing the penalizations of the station-dependent covariates (respective elements of penalization_stations_cov)</li>
<li>"coordinates": UTM coordinates of the stations of the training data (element coordinates_stations).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the stations (element kernel_bandwith_stations).</li>
</ul>
</li>
<li>"beta_Station": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element n_basis_beta_stations_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stations_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element degrees_basis_beta_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element knots_beta_stations_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation.</li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<p>constant basis are used, for a covariate, if it resembles a scalar shape. It consists of a straight line with y-value equal to 1 all over the data domain. Can be seen as a B-spline basis with degree 0, number of basis 1, using one knot, consequently having only one coefficient for the only basis for each statistical unit. fdagwr sets all the feats accordingly if reads constant basis. However, recall that the response is a functional datum, as the regressors coefficients. Since the package's basis variety could be hopefully enlarged in the future (for example, introducing Fourier basis for handling data that present periodical behaviors), the input parameters regarding basis types for response, response reconstruction weights and regressors coefficients are left at the end of the input list, and defaulted as NULL. Consequently they will use a B-spline basis system, and should NOT use a constant basis, Recall to perform externally the basis expansion before using the package, and afterwards passing basis types, degree and number and basis expansion coefficients and knots coherently </p><dl class="section note"><dt>Note</dt><dd>a little excursion about degree and number of basis passed as input. For each specific covariate, or the response, if using B-spline basis, remember that number of knots = number of basis - degree + 1. By default, if passing NULL, fdagwr uses a cubic B-spline system of basis, the number of basis is computed coherently from the number of knots (that is the only mandatory input parameter). Passing only the degree of the bsplines, the number of basis used will be set accordingly, and viceversa if passing only the number of basis. But, take care that the number of basis used has to match the number of rows of coefficients matrix (for EACH type of basis). If not, an exception is thrown. No problems arise if letting fdagwr defaulting the number of basis. For response and response reconstruction weights, degree and number of basis consist of integer, and can be NULL. For all the regressors, and their coefficients, the inputs consist of vector of integers: if willing to pass a default parameter, all the vector has to be defaulted (if passing NULL, a vector with all 3 for the degrees is passed, for example) <a class="el" href="">https://www.researchgate.net/publication/377251714_Weighted_Functional_Data_Analysis_for_the_Calibration_of_a_Ground_Motion_Model_in_Italy</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_ab2868ec905e0f8714b773c423f63d3eb_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_ab2868ec905e0f8714b773c423f63d3eb_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="aa047822d2daf52e16fc2bd9d55fa38ff" name="aa047822d2daf52e16fc2bd9d55fa38ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa047822d2daf52e16fc2bd9d55fa38ff">&#9670;&#160;</a></span>FMSGWR_SEC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List FMSGWR_SEC </td>
          <td>(</td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>t_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>left_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>right_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_events</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_events</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_events_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_stations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>kernel_bandwith_stations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stations_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>in_cascade_estimation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_rec_weights_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_events_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stations_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fitting a Functional Multi-Source Geographically Weighted Regression SEC model. The covariates are functional objects, divided into three categories: stationary covariates (C), constant over geographical space, event-dependent covariates (E), that vary depending on the spatial coordinates of the event, station-dependent covariates (S), that vary depending on the spatial coordinates of the stations that measure the event. Regression coefficients are estimated in the following order: C, E, S. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_points</td><td>matrix of double containing the raw response: each row represents a specific abscissa for which the response evaluation is available, each column a statistical unit. Response is a already reconstructed. </td></tr>
    <tr><td class="paramname">t_points</td><td>vector of double with the abscissa points with respect of the raw evaluations of y_points are available (length of t_points is equal to the number of rows of y_points). </td></tr>
    <tr><td class="paramname">left_extreme_domain</td><td>double indicating the left extreme of the functional data domain (not necessarily the smaller element in t_points). </td></tr>
    <tr><td class="paramname">right_extreme_domain</td><td>double indicating the right extreme of the functional data domain (not necessarily the biggest element in t_points). </td></tr>
    <tr><td class="paramname">coeff_y_points</td><td>matrix of double containing the coefficient of response's basis expansion: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">knots_y_points</td><td>vector of double with the abscissa points with respect which the basis expansions of the response and response reconstruction weights are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degree_basis_y_points</td><td>non-negative integer: the degree of the basis used for the basis expansion of the (functional) response. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_y_points</td><td>positive integer: number of basis for the basis expansion of the (functional) response. It must match number of rows of coeff_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_rec_weights_y_points</td><td>matrix of double containing the coefficients of the basis expansion of the weights to reconstruct the (functional) response: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">degree_basis_rec_weights_y_points</td><td>non-negative integer: the degree of the basis used for response reconstruction weights. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_rec_weights_y_points</td><td>positive integer: number of basis for the basis expansion of response reconstruction weights. It must match number of rows of coeff_rec_weights_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stationary covariate (default: "reg.Ci" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate. It must match number of rows of the i-th element of coeff_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stationary covariate. </td></tr>
    <tr><td class="paramname">knots_beta_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_events_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th events-dependent covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th events-dependent covariate (default: "reg.Ei" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_events_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_events_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the events-dependent covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_events_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th events-dependent covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_events_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th events-dependent covariate. It must match number of rows of the i-th element of coeff_events_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_events_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th events-dependent covariate. </td></tr>
    <tr><td class="paramname">coordinates_events</td><td>matrix of double containing the UTM coordinates of the event of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_events</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within events. </td></tr>
    <tr><td class="paramname">knots_beta_events_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the events-dependent covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_events_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th events-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_events_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th events-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stations_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stations-dependent covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stations-dependent covariate (default: "reg.Si"). </td></tr>
    <tr><td class="paramname">basis_types_stations_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stations-dependent covariates basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stations_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stations-dependent covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stations_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stations-dependent covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stations_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stations-dependent covariate. It must match number of rows of the i-th element of coeff_stations_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stations_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stations-dependent covariate. </td></tr>
    <tr><td class="paramname">coordinates_stations</td><td>matrix of double containing the UTM coordinates of the station of each statistical unit: each row represents a statistical unit, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">kernel_bandwith_stations</td><td>positive double indicating the bandwith of the gaussian kernel used to smooth the distances within stations. </td></tr>
    <tr><td class="paramname">knots_beta_stations_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stations-dependent covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stations_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stations-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stations_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stations-dependent covariate functional regression coefficient. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">in_cascade_estimation</td><td>bool: if false, an exact algorithm taking account for the interaction within non-stationary covariates is used to fit the model. Otherwise, the model is fitted in cascade. The first option is more precise, but way more computationally intensive. </td></tr>
    <tr><td class="paramname">n_knots_smoothing</td><td>number of knots used to perform the smoothing on the response obtained leaving out all the non-stationary components (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
    <tr><td class="paramname">basis_type_y_points</td><td>string containing the type of basis used for the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_type_rec_weights_y_points</td><td>string containing the type of basis used for the weights to reconstruct the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_events_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th events-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stations_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stations-dependent covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMSGWR_SEC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Be": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Le_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_events_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_events_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_events_cov)</li>
</ul>
</li>
<li>"Beta_e": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"Bs": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Ls_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_stations_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stations_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stations_cov)</li>
</ul>
</li>
<li>"Beta_s": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
<li>"A__": vector of matrices with the operator A_s for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
<li>"B__for_K": vector of matrices with the operator B_s used for the K_s_e(t) computation, for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_Event": list:<ul>
<li>"number_covariates": number of event-dependent covariates (length of coeff_events_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional event-dependent covariates (respective elements of n_basis_events_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional event-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_events_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional event-dependent covariates (respective elements of degrees_basis_events_cov).</li>
<li>"knots": knots used to make the basis expansion of functional event-dependent covariates (element knots_events_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional event-dependent covariates (respective elements of coeff_events_cov).</li>
<li>"penalizations": vector containing the penalizations of the event-dependent covariates (respective elements of penalization_events_cov)</li>
<li>"coordinates": UTM coordinates of the events of the training data (element coordinates_events).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the events (element kernel_bandwith_events).</li>
</ul>
</li>
<li>"beta_Event": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element n_basis_beta_events_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_events_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element degrees_basis_beta_events_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element knots_beta_events_cov).</li>
</ul>
</li>
<li>"cov_Station": list:<ul>
<li>"number_covariates": number of station-dependent covariates (length of coeff_stations_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional station-dependent covariates (respective elements of n_basis_stations_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional station-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stations_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional station-dependent covariates (respective elements of degrees_basis_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of functional station-dependent covariates (element knots_stations_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional station-dependent covariates (respective elements of coeff_stations_cov).</li>
<li>"penalizations": vector containing the penalizations of the station-dependent covariates (respective elements of penalization_stations_cov)</li>
<li>"coordinates": UTM coordinates of the stations of the training data (element coordinates_stations).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the stations (element kernel_bandwith_stations).</li>
</ul>
</li>
<li>"beta_Station": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element n_basis_beta_stations_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stations_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element degrees_basis_beta_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element knots_beta_stations_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation.</li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<p>constant basis are used, for a covariate, if it resembles a scalar shape. It consists of a straight line with y-value equal to 1 all over the data domain. Can be seen as a B-spline basis with degree 0, number of basis 1, using one knot, consequently having only one coefficient for the only basis for each statistical unit. fdagwr sets all the feats accordingly if reads constant basis. However, recall that the response is a functional datum, as the regressors coefficients. Since the package's basis variety could be hopefully enlarged in the future (for example, introducing Fourier basis for handling data that present periodical behaviors), the input parameters regarding basis types for response, response reconstruction weights and regressors coefficients are left at the end of the input list, and defaulted as NULL. Consequently they will use a B-spline basis system, and should NOT use a constant basis, Recall to perform externally the basis expansion before using the package, and afterwards passing basis types, degree and number and basis expansion coefficients and knots coherently </p><dl class="section note"><dt>Note</dt><dd>a little excursion about degree and number of basis passed as input. For each specific covariate, or the response, if using B-spline basis, remember that number of knots = number of basis - degree + 1. By default, if passing NULL, fdagwr uses a cubic B-spline system of basis, the number of basis is computed coherently from the number of knots (that is the only mandatory input parameter). Passing only the degree of the bsplines, the number of basis used will be set accordingly, and viceversa if passing only the number of basis. But, take care that the number of basis used has to match the number of rows of coefficients matrix (for EACH type of basis). If not, an exception is thrown. No problems arise if letting fdagwr defaulting the number of basis. For response and response reconstruction weights, degree and number of basis consist of integer, and can be NULL. For all the regressors, and their coefficients, the inputs consist of vector of integers: if willing to pass a default parameter, all the vector has to be defaulted (if passing NULL, a vector with all 3 for the degrees is passed, for example) <a class="el" href="">https://www.researchgate.net/publication/377251714_Weighted_Functional_Data_Analysis_for_the_Calibration_of_a_Ground_Motion_Model_in_Italy</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_aa047822d2daf52e16fc2bd9d55fa38ff_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_aa047822d2daf52e16fc2bd9d55fa38ff_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a1ca1a9836bffb181af6fc761393d23f1" name="a1ca1a9836bffb181af6fc761393d23f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca1a9836bffb181af6fc761393d23f1">&#9670;&#160;</a></span>FWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List FWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>t_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>left_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>right_extreme_domain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coeff_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>degree_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_rec_weights_y_points</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>penalization_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>knots_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>degrees_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::IntegerVector &gt;</td>          <td class="paramname"><span class="paramname"><em>n_basis_beta_stationary_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>basis_type_rec_weights_y_points</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;bsplines&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; Rcpp::CharacterVector &gt;</td>          <td class="paramname"><span class="paramname"><em>basis_types_beta_stationary_cov</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fitting a Functional Weighted Regression model. The covariates are functional objects, stationary covariates (C), constant over geographical space. The functional response is already reconstructed according to the method proposed by Bortolotti et Al. (2024) (link below) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_points</td><td>matrix of double containing the raw response: each row represents a specific abscissa for which the response evaluation is available, each column a statistical unit. Response is a already reconstructed. </td></tr>
    <tr><td class="paramname">t_points</td><td>vector of double with the abscissa points with respect of the raw evaluations of y_points are available (length of t_points is equal to the number of rows of y_points). </td></tr>
    <tr><td class="paramname">left_extreme_domain</td><td>double indicating the left extreme of the functional data domain (not necessarily the smaller element in t_points). </td></tr>
    <tr><td class="paramname">right_extreme_domain</td><td>double indicating the right extreme of the functional data domain (not necessarily the biggest element in t_points). </td></tr>
    <tr><td class="paramname">coeff_y_points</td><td>matrix of double containing the coefficient of response's basis expansion: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">knots_y_points</td><td>vector of double with the abscissa points with respect which the basis expansions of the response and response reconstruction weights are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degree_basis_y_points</td><td>non-negative integer: the degree of the basis used for the basis expansion of the (functional) response. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_y_points</td><td>positive integer: number of basis for the basis expansion of the (functional) response. It must match number of rows of coeff_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_rec_weights_y_points</td><td>matrix of double containing the coefficients of the basis expansion of the weights to reconstruct the (functional) response: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. </td></tr>
    <tr><td class="paramname">degree_basis_rec_weights_y_points</td><td>non-negative integer: the degree of the basis used for response reconstruction weights. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_rec_weights_y_points</td><td>positive integer: number of basis for the basis expansion of response reconstruction weights. It must match number of rows of coeff_rec_weights_y_points. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">coeff_stationary_cov</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit. The name of the i-th element is the name of the i-th stationary covariate (default: "reg.Ci" if no name present). </td></tr>
    <tr><td class="paramname">basis_types_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">knots_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate. It must match number of rows of the i-th element of coeff_stationary_cov. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">penalization_stationary_cov</td><td>vector of non-negative double: element i-th is the penalization used for the i-th stationary covariate. </td></tr>
    <tr><td class="paramname">knots_beta_stationary_cov</td><td>vector of double with the abscissa points with respect which the basis expansions of the stationary covariates functional regression coefficients are performed (all elements contained in [a,b]). </td></tr>
    <tr><td class="paramname">degrees_basis_beta_stationary_cov</td><td>vector of non-negative integers: element i-th is the degree of the basis used for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_basis_beta_stationary_cov</td><td>vector of positive integers: element i-th is the number of basis for the basis expansion of the i-th stationary covariate functional regression coefficients. Default explained below (can be NULL). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
    <tr><td class="paramname">basis_type_y_points</td><td>string containing the type of basis used for the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_type_rec_weights_y_points</td><td>string containing the type of basis used for the weights to reconstruct the functional response basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
    <tr><td class="paramname">basis_types_beta_stationary_cov</td><td>vector of strings, element i-th containing the type of basis used for the i-th stationary covariate functional regression coefficients basis expansion. Possible values: "bsplines", "constant". Defalut: "bsplines". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FWR")</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing information of the fitted model to perform predictions for new statistical units:<ul>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<p>constant basis are used, for a covariate, if it resembles a scalar shape. It consists of a straight line with y-value equal to 1 all over the data domain. Can be seen as a B-spline basis with degree 0, number of basis 1, using one knot, consequently having only one coefficient for the only basis for each statistical unit. fdagwr sets all the feats accordingly if reads constant basis. However, recall that the response is a functional datum, as the regressors coefficients. Since the package's basis variety could be hopefully enlarged in the future (for example, introducing Fourier basis for handling data that present periodical behaviors), the input parameters regarding basis types for response, response reconstruction weights and regressors coefficients are left at the end of the input list, and defaulted as NULL. Consequently they will use a B-spline basis system, and should NOT use a constant basis, Recall to perform externally the basis expansion before using the package, and afterwards passing basis types, degree and number and basis expansion coefficients and knots coherently </p><dl class="section note"><dt>Note</dt><dd>a little excursion about degree and number of basis passed as input. For each specific covariate, or the response, if using B-spline basis, remember that number of knots = number of basis - degree + 1. By default, if passing NULL, fdagwr uses a cubic B-spline system of basis, the number of basis is computed coherently from the number of knots (that is the only mandatory input parameter). Passing only the degree of the bsplines, the number of basis used will be set accordingly, and viceversa if passing only the number of basis. But, take care that the number of basis used has to match the number of rows of coefficients matrix (for EACH type of basis). If not, an exception is thrown. No problems arise if letting fdagwr defaulting the number of basis. For response and response reconstruction weights, degree and number of basis consist of integer, and can be NULL. For all the regressors, and their coefficients, the inputs consist of vector of integers: if willing to pass a default parameter, all the vector has to be defaulted (if passing NULL, a vector with all 3 for the degrees is passed, for example) <a class="el" href="">https://www.researchgate.net/publication/377251714_Weighted_Functional_Data_Analysis_for_the_Calibration_of_a_Ground_Motion_Model_in_Italy</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_a1ca1a9836bffb181af6fc761393d23f1_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_a1ca1a9836bffb181af6fc761393d23f1_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab1a6dc026ab68e19a1483bb7989a9c7e" name="ab1a6dc026ab68e19a1483bb7989a9c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1a6dc026ab68e19a1483bb7989a9c7e">&#9670;&#160;</a></span>installation_fdagwr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void installation_fdagwr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check fdagwr package installation. </p>

</div>
</div>
<a id="a1232970b791dea772ef48d61fc329d87" name="a1232970b791dea772ef48d61fc329d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1232970b791dea772ef48d61fc329d87">&#9670;&#160;</a></span>predict_FGWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List predict_FGWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_non_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_non_stationary_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>units_to_be_predicted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>abscissa_ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>model_fitted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing_pred</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to perform predictions on new statistical units using a fitted Functional Geographically Weighted Regression model. Non-stationary betas have to be recomputed in the new locations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff_non_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th non-stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coordinates_non_stationary_to_pred</td><td>matrix of double containing the UTM coordinates of the non-stationary site of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">units_to_be_predicted</td><td>number of units to be predicted </td></tr>
    <tr><td class="paramname">abscissa_ev</td><td>abscissa for which then evaluating the predicted reponse and betas, stationary and non-stationary, which have to be recomputed </td></tr>
    <tr><td class="paramname">model_fitted</td><td>output of FGWR: an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FGWR")</li>
<li>"Bnc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Lnc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_non_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_non_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_non_stationary_cov)</li>
</ul>
</li>
<li>"Beta_nc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"predictor_info": a list containing information of the fitted model to perform predictions for new statistical units:<ul>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points). <br  />
</li>
</ul>
</li>
<li>"cov_NonStationary": list:<ul>
<li>"number_covariates": number of non-stationary covariates (length of coeff_non_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional non-stationary covariates (respective elements of n_basis_non_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional non-stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_non_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional non-stationary covariates (respective elements of degrees_basis_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional non-stationary covariates (element knots_non_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional non-stationary covariates (respective elements of coeff_non_stationary_cov).</li>
<li>"penalizations": vector containing the penalizations of the non-stationary covariates (respective elements of penalization_non_stationary_cov)</li>
<li>"coordinates": UTM coordinates of the non-stationary sites of the training data (element coordinates_non_stationary).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the non-stationary sites (element kernel_bandwith_non_stationary).</li>
</ul>
</li>
<li>"beta_NonStationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element n_basis_beta_non_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_non_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element degrees_basis_beta_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element knots_beta_non_stationary_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points). </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">n_knots_smoothing_pred</td><td>number of knots used to smooth predicted response and non-stationary, obtaining basis expansion coefficients with respect to the training basis (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR_predictor": string containing the model used to predict ("predictor_FGWR")</li>
<li>"prediction": list containing:<ul>
<li>"evaluation": list containing the evaluation of the prediction:<ul>
<li>"prediction_ev": list containing, for each unit to be predicted, the raw evaluations of the predicted response.</li>
<li>"abscissa_ev": the abscissa points for which the prediction evaluation is available (element abscissa_ev).</li>
</ul>
</li>
<li>"fd": list containing the prediction functional description:<ul>
<li>"prediction_basis_coeff": matrix containing the prediction basis expansion coefficients (each row a basis, each column a new statistical unit)</li>
<li>"prediction_basis_type": basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_num": number of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_deg": degree of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_knots": knots used for the predicted response smoothing (n_knots_smoothing_pred equally spaced knots in the functional datum domain)</li>
</ul>
</li>
</ul>
</li>
<li>"Bnc_pred": list containing, for each non-stationary covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_nc_pred": list containing, for each non-stationary covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
</ul>
</dd></dl>
<p>NB: Covariates of units to be predicted have to be sampled in the same sample points for which the training data have been (t_points). Covariates basis expansion for the units to be predicted has to be done with respect to the basis used for the covariates in the training set </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_a1232970b791dea772ef48d61fc329d87_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_a1232970b791dea772ef48d61fc329d87_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a58e1b7194996c682ee8a9c80162c4433" name="a58e1b7194996c682ee8a9c80162c4433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e1b7194996c682ee8a9c80162c4433">&#9670;&#160;</a></span>predict_FMGWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List predict_FMGWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_non_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_non_stationary_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>units_to_be_predicted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>abscissa_ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>model_fitted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing_pred</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to perform predictions on new statistical units using a fitted Functional Mixed Geographically Weighted Regression model. Non-stationary betas have to be recomputed in the new locations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coeff_non_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th non-stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coordinates_non_stationary_to_pred</td><td>matrix of double containing the UTM coordinates of the non-stationary site of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">units_to_be_predicted</td><td>number of units to be predicted </td></tr>
    <tr><td class="paramname">abscissa_ev</td><td>abscissa for which then evaluating the predicted reponse and betas, stationary and non-stationary, which have to be recomputed </td></tr>
    <tr><td class="paramname">model_fitted</td><td>output of FMGWR: an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMGWR")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Bnc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Lnc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_non_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_non_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_non_stationary_cov)</li>
</ul>
</li>
<li>"Beta_nc": a list containing, for each non-stationary covariate regression coefficent (each element is named with the element names in the list coeff_non_stationary_cov (default, if not given: "CovNC*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_NonStationary": list:<ul>
<li>"number_covariates": number of non-stationary covariates (length of coeff_non_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional non-stationary covariates (respective elements of n_basis_non_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional non-stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_non_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional non-stationary covariates (respective elements of degrees_basis_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional non-stationary covariates (element knots_non_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional non-stationary covariates (respective elements of coeff_non_stationary_cov).</li>
<li>"penalizations": vector containing the penalizations of the non-stationary covariates (respective elements of penalization_non_stationary_cov)</li>
<li>"coordinates": UTM coordinates of the non-stationary sites of the training data (element coordinates_non_stationary).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the non-stationary sites (element kernel_bandwith_non_stationary).</li>
</ul>
</li>
<li>"beta_NonStationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element n_basis_beta_non_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_non_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element degrees_basis_beta_non_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the non-stationary covariates (element knots_beta_non_stationary_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation. </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">n_knots_smoothing_pred</td><td>number of knots used to smooth predicted response and non-stationary, obtaining basis expansion coefficients with respect to the training basis (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR_predictor": string containing the model used to predict ("predictor_FMGWR")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation in the fitted model false, "Cascade" if in_cascade_estimation in the fitted model true</li>
<li>"prediction": list containing:<ul>
<li>"evaluation": list containing the evaluation of the prediction:<ul>
<li>"prediction_ev": list containing, for each unit to be predicted, the raw evaluations of the predicted response.</li>
<li>"abscissa_ev": the abscissa points for which the prediction evaluation is available (element abscissa_ev).</li>
</ul>
</li>
<li>"fd": list containing the prediction functional description:<ul>
<li>"prediction_basis_coeff": matrix containing the prediction basis expansion coefficients (each row a basis, each column a new statistical unit)</li>
<li>"prediction_basis_type": basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_num": number of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_deg": degree of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_knots": knots used for the predicted response smoothing (n_knots_smoothing_pred equally spaced knots in the functional datum domain)</li>
</ul>
</li>
</ul>
</li>
<li>"Bc_pred": list containing, for each stationary covariate:<ul>
<li>"basis_coeff": coefficients of the basis expansion of the beta (from model_fitted).</li>
<li>"basis_num": number of basis used for the beta basis epxnasion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_c_pred": list containing, for each stationary covariate:<ul>
<li>"Beta_eval": evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
<li>"Bnc_pred": list containing, for each non-stationary covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_nc_pred": list containing, for each non-stationary covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
</ul>
</dd></dl>
<p>NB: Covariates of units to be predicted have to be sampled in the same sample points for which the training data have been (t_points). Covariates basis expansion for the units to be predicted has to be done with respect to the basis used for the covariates in the training set </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_a58e1b7194996c682ee8a9c80162c4433_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_a58e1b7194996c682ee8a9c80162c4433_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab00c87d9118ac0d945788764202c01e3" name="ab00c87d9118ac0d945788764202c01e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab00c87d9118ac0d945788764202c01e3">&#9670;&#160;</a></span>predict_FMSGWR_ESC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List predict_FMSGWR_ESC </td>
          <td>(</td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_events_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_events_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stations_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_stations_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>units_to_be_predicted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>abscissa_ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>model_fitted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing_pred</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to perform predictions on new statistical units using a fitted Functional Multi-Source Geographically Weighted Regression ESC model. Non-stationary betas have to be recomputed in the new locations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coeff_events_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th event-dependent covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coordinates_events_to_pred</td><td>matrix of double containing the UTM coordinates of the event of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">coeff_stations_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th station-dependent covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a new statistical unit. </td></tr>
    <tr><td class="paramname">coordinates_stations_to_pred</td><td>matrix of double containing the UTM coordinates of the station of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">units_to_be_predicted</td><td>number of units to be predicted </td></tr>
    <tr><td class="paramname">abscissa_ev</td><td>abscissa for which then evaluating the predicted reponse and betas, stationary and non-stationary, which have to be recomputed </td></tr>
    <tr><td class="paramname">model_fitted</td><td>output of FMSGWR_ESC: an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMSGWR_ESC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Be": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Le_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_events_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_events_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_events_cov)</li>
</ul>
</li>
<li>"Beta_e": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"Bs": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Ls_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_stations_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stations_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stations_cov)</li>
</ul>
</li>
<li>"Beta_s": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
<li>"A__": vector of matrices with the operator A_e for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
<li>"B__for_K": vector of matrices with the operator B_e used for the K_e_s(t) computation, for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_Event": list:<ul>
<li>"number_covariates": number of event-dependent covariates (length of coeff_events_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional event-dependent covariates (respective elements of n_basis_events_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional event-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_events_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional event-dependent covariates (respective elements of degrees_basis_events_cov).</li>
<li>"knots": knots used to make the basis expansion of functional event-dependent covariates (element knots_events_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional event-dependent covariates (respective elements of coeff_events_cov).</li>
<li>"penalizations": vector containing the penalizations of the event-dependent covariates (respective elements of penalization_events_cov)</li>
<li>"coordinates": UTM coordinates of the events of the training data (element coordinates_events).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the events (element kernel_bandwith_events).</li>
</ul>
</li>
<li>"beta_Event": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element n_basis_beta_events_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_events_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element degrees_basis_beta_events_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element knots_beta_events_cov).</li>
</ul>
</li>
<li>"cov_Station": list:<ul>
<li>"number_covariates": number of station-dependent covariates (length of coeff_stations_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional station-dependent covariates (respective elements of n_basis_stations_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional station-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stations_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional station-dependent covariates (respective elements of degrees_basis_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of functional station-dependent covariates (element knots_stations_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional station-dependent covariates (respective elements of coeff_stations_cov).</li>
<li>"penalizations": vector containing the penalizations of the station-dependent covariates (respective elements of penalization_stations_cov)</li>
<li>"coordinates": UTM coordinates of the stations of the training data (element coordinates_stations).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the stations (element kernel_bandwith_stations).</li>
</ul>
</li>
<li>"beta_Station": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element n_basis_beta_stations_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stations_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element degrees_basis_beta_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element knots_beta_stations_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation. </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">n_knots_smoothing_pred</td><td>number of knots used to smooth predicted response and non-stationary, obtaining basis expansion coefficients with respect to the training basis (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR_predictor": string containing the model used to predict ("predictor_FMSGWR_ESC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation in the fitted model false, "Cascade" if in_cascade_estimation in the fitted model true</li>
<li>"prediction": list containing:<ul>
<li>"evaluation": list containing the evaluation of the prediction:<ul>
<li>"prediction_ev": list containing, for each unit to be predicted, the raw evaluations of the predicted response.</li>
<li>"abscissa_ev": the abscissa points for which the prediction evaluation is available (element abscissa_ev).</li>
</ul>
</li>
<li>"fd": list containing the prediction functional description:<ul>
<li>"prediction_basis_coeff": matrix containing the prediction basis expansion coefficients (each row a basis, each column a new statistical unit)</li>
<li>"prediction_basis_type": basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_num": number of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_deg": degree of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_knots": knots used for the predicted response smoothing (n_knots_smoothing_pred equally spaced knots in the functional datum domain)</li>
</ul>
</li>
</ul>
</li>
<li>"Bc_pred": list containing, for each stationary covariate:<ul>
<li>"basis_coeff": coefficients of the basis expansion of the beta (from model_fitted).</li>
<li>"basis_num": number of basis used for the beta basis epxnasion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_c_pred": list containing, for each stationary covariate:<ul>
<li>"Beta_eval": evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
<li>"Be_pred": list containing, for each event-dependent covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_e_pred": list containing, for each event-dependent covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
<li>"Bs_pred": list containing, for each station-dependent covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_s_pred": list containing, for each station-dependent covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
</ul>
</dd></dl>
<p>NB: Covariates of units to be predicted have to be sampled in the same sample points for which the training data have been (t_points). Covariates basis expansion for the units to be predicted has to be done with respect to the basis used for the covariates in the training set </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_ab00c87d9118ac0d945788764202c01e3_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_ab00c87d9118ac0d945788764202c01e3_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab96430b819b4aca0b81fad6da2b4ff26" name="ab96430b819b4aca0b81fad6da2b4ff26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96430b819b4aca0b81fad6da2b4ff26">&#9670;&#160;</a></span>predict_FMSGWR_SEC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List predict_FMSGWR_SEC </td>
          <td>(</td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_events_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_events_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stations_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericMatrix</td>          <td class="paramname"><span class="paramname"><em>coordinates_stations_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>units_to_be_predicted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>abscissa_ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>model_fitted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing_pred</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_intervals_quadrature</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to perform predictions on new statistical units using a fitted Functional Multi-Source Geographically Weighted Regression SEC model. Non-stationary betas have to be recomputed in the new locations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coeff_events_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th event-dependent covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">coordinates_events_to_pred</td><td>matrix of double containing the UTM coordinates of the event of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">coeff_stations_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th station-dependent covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a new statistical unit. </td></tr>
    <tr><td class="paramname">coordinates_stations_to_pred</td><td>matrix of double containing the UTM coordinates of the station of new statistical units: each row represents a statistical unit to be predicted, each column a coordinate (2 columns). </td></tr>
    <tr><td class="paramname">units_to_be_predicted</td><td>number of units to be predicted </td></tr>
    <tr><td class="paramname">abscissa_ev</td><td>abscissa for which then evaluating the predicted reponse and betas, stationary and non-stationary, which have to be recomputed </td></tr>
    <tr><td class="paramname">model_fitted</td><td>output of FMSGWR_SEC: an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FMSGWR_SEC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation false, "Cascade" if in_cascade_estimation true</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"Be": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Le_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_events_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_events_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_events_cov)</li>
</ul>
</li>
<li>"Beta_e": a list containing, for each event-dependent covariate regression coefficent (each element is named with the element names in the list coeff_events_cov (default, if not given: "CovE*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points) <br  />
</li>
</ul>
</li>
<li>"Bs": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"basis_coeff": a list, containg, for each unit, a Ls_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective elements of basis_types_beta_stations_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stations_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stations_cov)</li>
</ul>
</li>
<li>"Beta_s": a list containing, for each station-dependent covariate regression coefficent (each element is named with the element names in the list coeff_stations_cov (default, if not given: "CovS*")) a list with:<ul>
<li>"Beta_eval": a list containing vectors of double with the discrete evaluation of the non-stationary beta, one for each statistical unit</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing partial residuals and information of the fitted model to perform predictions for new statistical units:<ul>
<li>"partial_res": a list containing information to compute the partial residuals:<ul>
<li>"c_tilde_hat": vector of double with the basis expansion coefficients of the response minus the stationary component of the phenomenon (if in_cascade_estimation is true, contains only 0s).</li>
<li>"A__": vector of matrices with the operator A_s for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
<li>"B__for_K": vector of matrices with the operator B_s used for the K_s_e(t) computation, for each statistical unit (if in_cascade_estimation is true, each matrix contains only 0s).</li>
</ul>
</li>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response (element coeff_y_points).</li>
</ul>
</li>
<li>"ResponseReconstructionWeights": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response reconstruction weights (element n_basis_rec_weights_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response reconstruction weights. Possible values: "bsplines", "constant". (element basis_type_rec_weights_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response reconstruction weights (element degree_basis_rec_weights_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response reconstruction weights (element knots_y_points).</li>
<li>"basis_coeff": matrix containing the coefficients of the basis expansion of the functional response reconstruction weights (element coeff_rec_weights_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional stationary covariates (respective elements of coeff_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"cov_Event": list:<ul>
<li>"number_covariates": number of event-dependent covariates (length of coeff_events_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional event-dependent covariates (respective elements of n_basis_events_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional event-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_events_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional event-dependent covariates (respective elements of degrees_basis_events_cov).</li>
<li>"knots": knots used to make the basis expansion of functional event-dependent covariates (element knots_events_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional event-dependent covariates (respective elements of coeff_events_cov).</li>
<li>"penalizations": vector containing the penalizations of the event-dependent covariates (respective elements of penalization_events_cov)</li>
<li>"coordinates": UTM coordinates of the events of the training data (element coordinates_events).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the events (element kernel_bandwith_events).</li>
</ul>
</li>
<li>"beta_Event": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element n_basis_beta_events_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_events_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element degrees_basis_beta_events_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the event-dependent covariates (element knots_beta_events_cov).</li>
</ul>
</li>
<li>"cov_Station": list:<ul>
<li>"number_covariates": number of station-dependent covariates (length of coeff_stations_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional station-dependent covariates (respective elements of n_basis_stations_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional station-dependent covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stations_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional station-dependent covariates (respective elements of degrees_basis_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of functional station-dependent covariates (element knots_stations_cov).</li>
<li>"basis_coeff": list containing the matrices with the coefficients of the basis expansion of the functional station-dependent covariates (respective elements of coeff_stations_cov).</li>
<li>"penalizations": vector containing the penalizations of the station-dependent covariates (respective elements of penalization_stations_cov)</li>
<li>"coordinates": UTM coordinates of the stations of the training data (element coordinates_stations).</li>
<li>"kernel_bwd": bandwith of the gaussian kernel used to smooth distances of the stations (element kernel_bandwith_stations).</li>
</ul>
</li>
<li>"beta_Station": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element n_basis_beta_stations_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stations_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element degrees_basis_beta_stations_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the station-dependent covariates (element knots_beta_stations_cov).</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points).</li>
<li>"InCascadeEstimation": element in_cascade_estimation. </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">n_knots_smoothing_pred</td><td>number of knots used to smooth predicted response and non-stationary, obtaining basis expansion coefficients with respect to the training basis (default: 100). </td></tr>
    <tr><td class="paramname">n_intervals_quadrature</td><td>number of intervals used while performing integration via midpoint (rectangles) quadrature rule (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR_predictor": string containing the model used to predict ("predictor_FMSGWR_SEC")</li>
<li>"EstimationTechnique": "Exact" if in_cascade_estimation in the fitted model false, "Cascade" if in_cascade_estimation in the fitted model true</li>
<li>"prediction": list containing:<ul>
<li>"evaluation": list containing the evaluation of the prediction:<ul>
<li>"prediction_ev": list containing, for each unit to be predicted, the raw evaluations of the predicted response.</li>
<li>"abscissa_ev": the abscissa points for which the prediction evaluation is available (element abscissa_ev).</li>
</ul>
</li>
<li>"fd": list containing the prediction functional description:<ul>
<li>"prediction_basis_coeff": matrix containing the prediction basis expansion coefficients (each row a basis, each column a new statistical unit)</li>
<li>"prediction_basis_type": basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_num": number of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_deg": degree of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_knots": knots used for the predicted response smoothing (n_knots_smoothing_pred equally spaced knots in the functional datum domain)</li>
</ul>
</li>
</ul>
</li>
<li>"Bc_pred": list containing, for each stationary covariate:<ul>
<li>"basis_coeff": coefficients of the basis expansion of the beta (from model_fitted).</li>
<li>"basis_num": number of basis used for the beta basis epxnasion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_c_pred": list containing, for each stationary covariate:<ul>
<li>"Beta_eval": evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
<li>"Be_pred": list containing, for each event-dependent covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_e_pred": list containing, for each event-dependent covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
<li>"Bs_pred": list containing, for each station-dependent covariate:<ul>
<li>"basis_coeff": list, one element for each unit to be predicted, with the recomputed coefficients of the basis expansion of the beta.</li>
<li>"basis_num": number of basis used for the beta basis expansion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_s_pred": list containing, for each station-dependent covariate:<ul>
<li>"Beta_eval": list containing, for each unit to be predicted, the evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
</ul>
</dd></dl>
<p>NB: Covariates of units to be predicted have to be sampled in the same sample points for which the training data have been (t_points). Covariates basis expansion for the units to be predicted has to be done with respect to the basis used for the covariates in the training set </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_ab96430b819b4aca0b81fad6da2b4ff26_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_ab96430b819b4aca0b81fad6da2b4ff26_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a051f0f57690b5a9ff81b9008b4bcee84" name="a051f0f57690b5a9ff81b9008b4bcee84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051f0f57690b5a9ff81b9008b4bcee84">&#9670;&#160;</a></span>predict_FWR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rcpp::List predict_FWR </td>
          <td>(</td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>coeff_stationary_cov_to_pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>units_to_be_predicted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::NumericVector</td>          <td class="paramname"><span class="paramname"><em>abscissa_ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::List</td>          <td class="paramname"><span class="paramname"><em>model_fitted</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_knots_smoothing_pred</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Rcpp::Nullable&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>num_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">R_NilValue</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to perform predictions on new statistical units using a fitted Functional Weighted Regression model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff_stationary_cov_to_pred</td><td>list of matrices of doubles: element i-th containing the coefficients for the basis expansion of the i-th stationary covariate to be predicted: each row represents a specific basis (by default: B-spline) of the basis system used, each column a statistical unit to be predicted. </td></tr>
    <tr><td class="paramname">units_to_be_predicted</td><td>number of units to be predicted </td></tr>
    <tr><td class="paramname">abscissa_ev</td><td>abscissa for which then evaluating the predicted reponse and betas, stationary and non-stationary, which have to be recomputed </td></tr>
    <tr><td class="paramname">model_fitted</td><td>output of FWR: an R list containing:<ul>
<li>"FGWR": string containing the type of fwr used ("FWR")</li>
<li>"Bc": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"basis_coeff": a Lc_jx1 vector of double, containing the coefficients of the basis expansion of the beta</li>
<li>"basis_type": a string containing the basis type over which the beta basis expansion is performed. Possible values: "bsplines", "constant". (Respective element of basis_types_beta_stationary_cov)</li>
<li>"basis_num": the number of basis used for performing the beta basis expansion (respective elements of n_basis_beta_stationary_cov)</li>
<li>"knots": the knots used to create the basis system for the beta (it is the input knots_beta_stationary_cov)</li>
</ul>
</li>
<li>"Beta_c": a list containing, for each stationary covariate regression coefficent (each element is named with the element names in the list coeff_stationary_cov (default, if not given: "CovC*")) a list with:<ul>
<li>"Beta_eval": a vector of double containing the discrete evaluations of the stationary beta</li>
<li>"Abscissa": the domain points for which the evaluation of the beta is available (it is the input t_points)</li>
</ul>
</li>
<li>"predictor_info": a list containing information of the fitted model to perform predictions for new statistical units:<ul>
<li>"inputs_info": a list containing information about the data used to fit the model:<ul>
<li>"Response": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional response (element n_basis_y_points).</li>
<li>"basis_type": basis used to make the basis expansion of the functional response. Possible values: "bsplines", "constant". (element basis_type_y_points).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional response (element degree_basis_y_points).</li>
<li>"knots": knots used to make the basis expansion of the functional response (element knots_y_points).</li>
</ul>
</li>
<li>"cov_Stationary": list:<ul>
<li>"number_covariates": number of stationary covariates (length of coeff_stationary_cov).</li>
<li>"basis_num": vector with the numbers of basis used to make the basis expansion of the functional stationary covariates (respective elements of n_basis_stationary_cov).</li>
<li>"basis_type": vector with type of basis used to make the basis expansion of the functional stationary covariates. Possible values: "bsplines", "constant". (respective elements of basis_types_stationary_cov).</li>
<li>"basis_deg": vector with the degree of basis used to make the basis expansion of functional stationary covariates (respective elements of degrees_basis_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of functional stationary covariates (element knots_stationary_cov).</li>
</ul>
</li>
<li>"beta_Stationary": list:<ul>
<li>"basis_num": number of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element n_basis_beta_stationary_cov).</li>
<li>"basis_type": basis used to make the basis expansion of the functional regression coefficients of the stationary covariates. Possible values: "bsplines", "constant". (element basis_types_beta_stationary_cov).</li>
<li>"basis_deg": degree of basis used to make the basis expansion of the functional regression coefficients of the stationary covariates (element degrees_basis_beta_stationary_cov).</li>
<li>"knots": knots used to make the basis expansion of the functional regression coefficients of the stationary covariates (element knots_beta_stationary_cov). <br  />
</li>
</ul>
</li>
<li>"a": domain left extreme (element left_extreme_domain).</li>
<li>"b": domain right extreme (element right_extreme_domain).</li>
<li>"abscissa": abscissa for which the evaluations of the functional data are available (element t_points). </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">n_knots_smoothing_pred</td><td>number of knots used to smooth predicted response and non-stationary, obtaining basis expansion coefficients with respect to the training basis (default: 100). </td></tr>
    <tr><td class="paramname">num_threads</td><td>number of threads to be used in OMP parallel directives. Default: maximum number of cores available in the machine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an R list containing:<ul>
<li>"FGWR_predictor": string containing the model used to predict ("predictor_FWR")</li>
<li>"prediction": list containing:<ul>
<li>"evaluation": list containing the evaluation of the prediction:<ul>
<li>"prediction_ev": list containing, for each unit to be predicted, the raw evaluations of the predicted response.</li>
<li>"abscissa_ev": the abscissa points for which the prediction evaluation is available (element abscissa_ev).</li>
</ul>
</li>
<li>"fd": list containing the prediction functional description:<ul>
<li>"prediction_basis_coeff": matrix containing the prediction basis expansion coefficients (each row a basis, each column a new statistical unit)</li>
<li>"prediction_basis_type": basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_num": number of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_basis_deg": degree of basis used for the predicted response basis expansion (from model_fitted)</li>
<li>"prediction_knots": knots used for the predicted response smoothing (n_knots_smoothing_pred equally spaced knots in the functional datum domain)</li>
</ul>
</li>
</ul>
</li>
<li>"Bc_pred": list containing, for each stationary covariate:<ul>
<li>"basis_coeff": coefficients of the basis expansion of the beta (from model_fitted).</li>
<li>"basis_num": number of basis used for the beta basis epxnasion (from model_fitted).</li>
<li>"basis_type": type of basis used for the beta basis expansion (from model_fitted).</li>
<li>"knots": knots used for the beta basis expansion (from model_fitted).</li>
</ul>
</li>
<li>"Beta_c_pred": list containing, for each stationary covariate:<ul>
<li>"Beta_eval": evaluation of the beta along a grid.</li>
<li>"Abscissa": grid (element abscissa_ev).</li>
</ul>
</li>
</ul>
</dd></dl>
<p>NB: Covariates of units to be predicted have to be sampled in the same sample points for which the training data have been (t_points). Covariates basis expansion for the units to be predicted has to be done with respect to the basis used for the covariates in the training set </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fda__gwr___r__interface_8cpp_a051f0f57690b5a9ff81b9008b4bcee84_cgraph.png" border="0" usemap="#afda__gwr___r__interface_8cpp_a051f0f57690b5a9ff81b9008b4bcee84_cgraph" alt=""/></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="fda__gwr___r__interface_8cpp.html">fda_gwr_R_interface.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.1 </li>
  </ul>
</div>
</body>
</html>
